        // ... (a kÃ³d tÃ¶bbi rÃ©sze vÃ¡ltozatlan, idÃ¡ig) ...

        // --- IdÅ‘rend GyakorlÃ³ JÃ¡tÃ©k Logika ---
        const timelineEvents = [ 
            { text: "Teleki PÃ¡l miniszterelnÃ¶ksÃ©gÃ©nek kezdete", year: 1920, month: 7, sortKey: 1920.07 },
            { text: "A Numerus Clausus tÃ¶rvÃ©ny bevezetÃ©se", year: 1920, month: 9, sortKey: 1920.09 }, 
            { text: "Az I. kirÃ¡lypuccs (IV. KÃ¡roly kÃ­sÃ©rlete)", year: 1921, month: 3, sortKey: 1921.03 }, 
            { text: "Teleki PÃ¡l lemondÃ¡sa", year: 1921, month: 4, sortKey: 1921.04 },
            { text: "Bethlen IstvÃ¡n miniszterelnÃ¶ksÃ©gÃ©nek kezdete", year: 1921, month: 4, sortKey: 1921.041 }, 
            { text: "A Bethlen-Peyer paktum megkÃ¶tÃ©se", year: 1921, month: 12, sortKey: 1921.12 }, 
            { text: "A II. kirÃ¡lypuccs (budaÃ¶rsi csata)", year: 1921, month: 10, sortKey: 1921.10 },
            { text: "A Habsburg-hÃ¡z trÃ³nfosztÃ¡sa (detronizÃ¡ciÃ³)", year: 1921, month: 11, sortKey: 1921.11 },
            { text: "MagyarorszÃ¡g belÃ©pÃ©se a NÃ©pszÃ¶vetsÃ©gbe", year: 1922, month: 9, sortKey: 1922.09 }, 
            { text: "Az Ãºj vÃ¡lasztÃ³jogi tÃ¶rvÃ©ny bevezetÃ©se (Bethlen)", year: 1922, month: 3, sortKey: 1922.03 }, 
            { text: "A Magyar Nemzeti Bank lÃ©trehozÃ¡sa", year: 1924, month: 6, sortKey: 1924.06 }, 
            { text: "Az Ãºj pÃ©nznem, a pengÅ‘ bevezetÃ©se", year: 1927, month: 1, sortKey: 1927.01 }, 
            { text: "Az olasz-magyar Ã¶rÃ¶kbarÃ¡tsÃ¡gi szerzÅ‘dÃ©s megkÃ¶tÃ©se", year: 1927, month: 4, sortKey: 1927.04 }
        ];

        let currentEventPair = [];
        let timelineAttempts = 0;
        let timelineCorrectAnswers = 0;
        let totalTimelineResponseTimeForCorrect = 0;
        let currentPairStartTime = 0;
        let timelineGameActive = false;
        let timelineRoundsPlayed = 0;
        const TIMELINE_ROUNDS_TOTAL = 10;

        const timelineStartScreen = document.getElementById('timeline-start-screen');
        const timelineGameContent = document.getElementById('timeline-game-content');
        const eventABtn = document.getElementById('eventA-btn');
        const eventBBtn = document.getElementById('eventB-btn');
        const timelineFeedback = document.getElementById('timeline-feedback');
        const nextPairBtn = document.getElementById('next-pair-btn');
        const timelineRoundCounter = document.getElementById('timeline-round-counter');

        const finalTimelineStatsDiv = document.getElementById('final-timeline-stats');
        const finalAttemptsDisplay = document.getElementById('final-attempts-display');
        const finalCorrectDisplay = document.getElementById('final-correct-display');
        const finalAccuracyDisplay = document.getElementById('final-accuracy-display');
        const finalAvgTimeDisplay = document.getElementById('final-avg-time-display');
        const finalMedalDisplay = document.getElementById('final-medal-display');


        function startTimelineGame() {
            timelineStartScreen.style.display = 'none';
            finalTimelineStatsDiv.style.display = 'none'; 
            timelineGameContent.style.display = 'block';
            document.querySelector('.event-options').style.display = 'block';
            timelineGameActive = true;
            timelineRoundsPlayed = 0;
            resetTimelineGameStats(); 
            loadNewEventPair();
        }
        
        function resetTimelineGameStats() { 
            timelineAttempts = 0;
            timelineCorrectAnswers = 0;
            totalTimelineResponseTimeForCorrect = 0; 
        }

        function showFinalTimelineStats() {
            timelineGameContent.style.display = 'none';
            finalTimelineStatsDiv.style.display = 'block';

            finalAttemptsDisplay.textContent = timelineAttempts;
            finalCorrectDisplay.textContent = timelineCorrectAnswers;
            const accuracy = timelineAttempts > 0 ? ((timelineCorrectAnswers / timelineAttempts) * 100).toFixed(0) : 0;
            finalAccuracyDisplay.textContent = accuracy;
            const avgTime = timelineCorrectAnswers > 0 ? (totalTimelineResponseTimeForCorrect / timelineCorrectAnswers / 1000).toFixed(1) : "N/A";
            finalAvgTimeDisplay.textContent = avgTime;

            let medalEmoji = "â³"; // AlapÃ©rtelmezett, ha nem Ã©r el semmit, vagy mÃ©g nincs elÃ©g adat
            if (timelineAttempts >= TIMELINE_ROUNDS_TOTAL) { 
                const accuracyRate = parseFloat(accuracy);
                const avgResponseSec = parseFloat(avgTime);

                if (accuracyRate >= 90 && !isNaN(avgResponseSec) && avgResponseSec <= 8) {
                    medalEmoji = "ðŸ¥‡";
                } else if (accuracyRate >= 75 && !isNaN(avgResponseSec) && avgResponseSec <= 12) {
                    medalEmoji = "ðŸ¥ˆ";
                } else if (accuracyRate >= 50) {
                    medalEmoji = "ðŸ¥‰";
                } else {
                    medalEmoji = "ðŸ‘Ž"; // Ha 50% alatt van a pontossÃ¡g 10 kÃ¶r utÃ¡n
                }
            }
            finalMedalDisplay.textContent = medalEmoji;
        }
        
        function loadNewEventPair() {
            if (!timelineGameActive) return; 

            if (timelineRoundsPlayed >= TIMELINE_ROUNDS_TOTAL) {
                showFinalTimelineStats();
                return;
            }
            timelineRoundsPlayed++;
            timelineRoundCounter.textContent = timelineRoundsPlayed;

            if (timelineEvents.length < 2) {
                timelineFeedback.textContent = "Nincs elÃ©g esemÃ©ny a jÃ¡tÃ©khoz.";
                eventABtn.style.display = "none";
                eventBBtn.style.display = "none";
                nextPairBtn.disabled = true;
                return;
            }
            eventABtn.style.display = "block";
            eventBBtn.style.display = "block";

            let indexA = Math.floor(Math.random() * timelineEvents.length);
            let indexB = Math.floor(Math.random() * timelineEvents.length);
            while (indexB === indexA) {
                indexB = Math.floor(Math.random() * timelineEvents.length);
            }
            currentEventPair = Math.random() < 0.5 ? [timelineEvents[indexA], timelineEvents[indexB]] : [timelineEvents[indexB], timelineEvents[indexA]];
            
            eventABtn.textContent = currentEventPair[0].text;
            eventBBtn.textContent = currentEventPair[1].text;

            eventABtn.classList.remove('correct', 'incorrect');
            eventBBtn.classList.remove('correct', 'incorrect');
            eventABtn.disabled = false;
            eventBBtn.disabled = false;
            timelineFeedback.textContent = "VÃ¡rom a vÃ¡laszod...";
            nextPairBtn.disabled = true; 
            currentPairStartTime = Date.now();
        }

        function checkTimelineOrder(selectedIndex) { 
            if (!timelineGameActive) return; 
            
            const responseTime = Date.now() - currentPairStartTime;
            timelineAttempts++; 

            const chosenEvent = currentEventPair[selectedIndex];
            const actualEarlierEvent = currentEventPair[0].sortKey < currentEventPair[1].sortKey ? currentEventPair[0] : currentEventPair[1];

            eventABtn.disabled = true;
            eventBBtn.disabled = true;
            nextPairBtn.disabled = false;

            if (chosenEvent.sortKey === actualEarlierEvent.sortKey) {
                timelineFeedback.textContent = `Helyes! (${(responseTime/1000).toFixed(1)} mp)`;
                timelineFeedback.style.color = "#2ECC71"; 
                if (selectedIndex === 0) eventABtn.classList.add('correct');
                else eventBBtn.classList.add('correct');
                timelineCorrectAnswers++; 
                totalTimelineResponseTimeForCorrect += responseTime; 
            } else {
                timelineFeedback.textContent = `Helytelen. A korÃ¡bbi: ${actualEarlierEvent.text} (${(responseTime/1000).toFixed(1)} mp)`;
                timelineFeedback.style.color = "#E74C3C";
                if (selectedIndex === 0) eventABtn.classList.add('incorrect');
                else eventBBtn.classList.add('incorrect');
                if(currentEventPair[0].sortKey === actualEarlierEvent.sortKey) eventABtn.classList.add('correct');
                else eventBBtn.classList.add('correct');
            }
        }
        
        // A kvÃ­z onload Ã©s egyÃ©b rÃ©szei vÃ¡ltozatlanok maradnak az elÅ‘zÅ‘ kÃ³dbÃ³l
        // ... (az allQuizQuestions tÃ¶mb Ã©s a kvÃ­zhez kapcsolÃ³dÃ³ JS fÃ¼ggvÃ©nyek itt helyezkednek el) ...
        // Az ablak betÃ¶ltÃ©sekor a kvÃ­z elindul egy random kÃ©rdÃ©ssel
        // Az idÅ‘rendi jÃ¡tÃ©k a start gombra vÃ¡r.

        // Hogy a teljes script meglegyen, idemÃ¡solom a kvÃ­zhez tartozÃ³ relevÃ¡ns rÃ©szeket is,
        // feltÃ©telezve, hogy az `allQuizQuestions` tÃ¶mbÃ¶t a felhasznÃ¡lÃ³ mÃ¡r kitÃ¶ltÃ¶tte
        // a kommentben jelzett helyen az elÅ‘zÅ‘ kÃ³dban.

        const allQuizQuestions = [
            // FONTOS: Ide mÃ¡sold be az Ã¶sszes kÃ©rdÃ©sedet a `short`, `explanation`, `simple` mezÅ‘kkel!
            { 
                section: "I. Teleki PÃ¡l miniszterelnÃ¶ksÃ©ge", 
                question: "Mikor volt Teleki PÃ¡l elsÅ‘ miniszterelnÃ¶ksÃ©ge?", 
                answer: {
                    short: "1920. jÃºlius â€“ 1921. Ã¡prilis.",
                    explanation: "Teleki PÃ¡l elsÅ‘ miniszterelnÃ¶ki idÅ‘szaka 1920 jÃºliusÃ¡tÃ³l 1921 Ã¡prilisÃ¡ig tartott, a TanÃ¡cskÃ¶ztÃ¡rsasÃ¡g bukÃ¡sa Ã©s a trianoni bÃ©keszerzÅ‘dÃ©s utÃ¡ni nehÃ©z idÅ‘kben.",
                    simple: "Teleki 1920-21 kÃ¶rÃ¼l volt elÅ‘szÃ¶r a fÅ‘nÃ¶k, amikor nagy volt a kÃ¡osz az orszÃ¡gban."
                }
            },
             { 
                section: "I. Teleki PÃ¡l miniszterelnÃ¶ksÃ©ge", 
                question: "Ki volt a fÃ¶ldmÅ±velÃ©si miniszter Teleki kormÃ¡nyÃ¡ban, aki a fÃ¶ldreformot kidolgozta?", 
                answer: {
                    short: "NagyatÃ¡di SzabÃ³ IstvÃ¡n.",
                    explanation: "NagyatÃ¡di SzabÃ³ IstvÃ¡n, a KisgazdapÃ¡rt vezetÅ‘ politikusa volt a fÃ¶ldmÅ±velÃ©si miniszter, Ã©s Å‘ felelt a Teleki-kormÃ¡ny fÃ¶ldreformjÃ¡nak elÅ‘kÃ©szÃ­tÃ©sÃ©Ã©rt.",
                    simple: "NagyatÃ¡di SzabÃ³ IstvÃ¡n prÃ³bÃ¡lt fÃ¶ldet adni a parasztoknak Teleki idejÃ©n."
                }
            },
            { 
                section: "II. Bethlen IstvÃ¡n konszolidÃ¡ciÃ³s politikÃ¡ja", 
                question: "Mit jelent a 'konszolidÃ¡ciÃ³' Bethlen IstvÃ¡n politikÃ¡jÃ¡ban?", 
                answer: {
                    short: "A tÃ¡rsadalmi, gazdasÃ¡gi Ã©s politikai helyzet stabilizÃ¡lÃ¡sÃ¡t, a nyugalom megteremtÃ©sÃ©t egy vÃ¡lsÃ¡gos idÅ‘szak utÃ¡n.",
                    explanation: "A bethleni konszolidÃ¡ciÃ³ cÃ©lja az volt, hogy a hÃ¡borÃº, forradalmak Ã©s Trianon utÃ¡ni bizonytalan, ingatag helyzetet megszilÃ¡rdÃ­tsa, Ã©s nyugalmat, stabilitÃ¡st teremtsen az orszÃ¡gban.",
                    simple: "Bethlen rendet akart tenni a nagy kÃ¡osz utÃ¡n, hogy az orszÃ¡g megnyugodjon Ã©s fejlÅ‘dni tudjon."
                }
            },
            // ... (Ã©s a tÃ¶bbi, Ã¡ltalad feltÃ¶ltÃ¶tt kÃ©rdÃ©s)
        ];

        let shuffledQuizQuestions = []; // Ezt a kvÃ­zhez hasznÃ¡ljuk

        const quizSectionTitleDisplay = document.getElementById('quiz-section-title-display');
        const quizQuestionDisplay = document.getElementById('question-display');
        const quizAnswerDisplayContainer = document.getElementById('answer-display-container');
        const quizAnswerDisplay = document.getElementById('answer-display');
        const quizExplanationDisplay = document.getElementById('explanation-display');
        const simpleExplanationDisplay = document.getElementById('simple-explanation-display');
        const quizShowAnswerBtn = document.getElementById('show-answer-btn');
        const quizNextQuestionBtn = document.getElementById('next-question-btn');
        
        function loadRandomQuizQuestion() {
            if (allQuizQuestions.length === 0) {
                quizQuestionDisplay.textContent = "Nincsenek kÃ©rdÃ©sek a kvÃ­zhez.";
                quizShowAnswerBtn.disabled = true;
                quizNextQuestionBtn.disabled = true;
                return;
            }
            
            shuffleArray(allQuizQuestions); 

            const randomIndex = Math.floor(Math.random() * allQuizQuestions.length);
            const q = allQuizQuestions[randomIndex];

            quizSectionTitleDisplay.textContent = q.section;
            quizQuestionDisplay.textContent = q.question;
            quizAnswerDisplay.textContent = q.answer.short;
            quizExplanationDisplay.textContent = q.answer.explanation;
            simpleExplanationDisplay.textContent = q.answer.simple;
            quizAnswerDisplayContainer.style.display = 'none';
            quizShowAnswerBtn.disabled = false;
            quizNextQuestionBtn.disabled = false; 
            quizNextQuestionBtn.textContent = "MÃ¡sik KÃ©rdÃ©s";
        }

        function showQuizAnswer() {
            quizAnswerDisplayContainer.style.display = 'block';
        }

        window.onload = () => {
            loadRandomQuizQuestion(); 
            timelineStartScreen.style.display = 'block';
            timelineGameContent.style.display = 'none';
            finalTimelineStatsDiv.style.display = 'none';
        };
    </script>
</body>
</html>
